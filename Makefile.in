include config.mk

obj = $(src:.c=.o)
dep = $(src:.c=.d)

incdir = -Isrc -Ilibs/imago/src
libdir = -Llibs/$(outdir)

CFLAGS = $(arch) $(warn) $(opt) $(dbg) $(incdir) $(CFLAGS_sys) $(depgen)
LDFLAGS = $(libdir) $(LDFLAGS_sys) -limago -lm

$(bin): $(obj) libs
	$(CC) -o $@ $(obj) $(LDFLAGS)

.c.o:
	$(CC) $(CFLAGS) -c -o $@ $<

.PHONY: clean
clean:
	rm -f $(obj)
	rm -f $(bin)

.PHONY: cleandep
cleandep:
	rm -f $(dep)

.PHONY: data
data:
	$(MAKE) -f tools/data.mk

.PHONY: tiles
tiles: data
	display -filter point -resize 200% data/tileset.png

.PHONY: libs
libs: imago

.PHONY: cleanlibs
cleanlibs: clean-imago

.PHONY: imago
imago:
	cd libs/imago; $(MAKE)

.PHONY: clean-imago
clean-imago:
	cd libs/imago; $(MAKE) clean

# vi:ft=make:
